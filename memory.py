import subprocess

class Volatility:
    def __init__(self, python_path, vol_path, mem_file, profile):
        self.mem_file = mem_file
        self.profile = profile
        self.volatility = vol_path
        self.python = python_path
        
    def run_cmd(self, cmd, args=[]):
        pargs = [self.python, self.volatility, self.profile, '-f', self.mem_file, cmd]
        if len(args):
            pargs.extend(args)
        proc = subprocess.Popen(pargs, stdout=subprocess.PIPE)
        return proc.communicate()[0]
    
    def psxview(self):
        return self.run_cmd('linux_psxview')
    
    def pslist(self):
        return self.run_cmd('linux_pslist')
    
    def pidhashtable(self):
        return self.run_cmd('linux_pidhashtable')
    
    def pstree(self):
        return self.run_cmd('linux_pstree')

    def psaux(self):
        return self.run_cmd('linux_psaux')

    def psenv(self):
        return self.run_cmd('linux_psenv')

    def threads(self):
        return self.run_cmd('linux_threads')

    def netstat(self):
        args = ["-U"]
        return self.run_cmd('linux_netstat', args)

    def ifconfig(self):
        return self.run_cmd('linux_ifconfig')

    def list_raw(self):
        return self.run_cmd('linux_list_raw')

    def library_list(self):
        return self.run_cmd('linux_library_list')

    def ldrmodules(self):
        return self.run_cmd('linux_ldrmodules')

    def lsmod(self):
        return self.run_cmd('linux_lsmod')

    def check_modules(self):
        return self.run_cmd('linux_check_modules')

    def hidden_modules(self):
        return self.run_cmd('linux_hidden_modules')

    def kernel_opened_files(self):
        return self.run_cmd('linux_kernel_opened_files')

    def check_creds(self):
        return self.run_cmd('linux_check_creds')

    def keyboard_notifiers(self):
        return self.run_cmd('linux_keyboard_notifiers')

    def check_tty(self):
        return self.run_cmd('linux_check_tty')

    def check_syscall(self):
        return self.run_cmd('linux_check_syscall')

    def bash_history(self):
        return self.run_cmd('linux_bash')

    def check_fop(self):
        return self.run_cmd('linux_check_fop')

    def check_afinfo(self):
        return self.run_cmd('linux_check_afinfo')

    def netfilter(self):
        return self.run_cmd('linux_netfilter')

    def check_inline_kernel(self):
        return self.run_cmd('linux_check_inline_kernel')

    def malfind(self):
        return self.run_cmd('linux_malfind')

    def plthook(self):
        return self.run_cmd('linux_plthook')

    def apihooks(self):
        return self.run_cmd('linux_apihooks')
